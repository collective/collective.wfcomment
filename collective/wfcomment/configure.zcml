<configure
    xmlns="http://namespaces.zope.org/zope"
    xmlns:gs="http://namespaces.zope.org/genericsetup"
    xmlns:browser="http://namespaces.zope.org/browser"
    xmlns:i18n="http://namespaces.zope.org/i18n"
    xmlns:grok="http://namespaces.zope.org/grok"
    i18n_domain="collective.wfcomment">

  <include package="Products.CMFCore" file="permissions.zcml" />
  <include package="plone.app.registry" />

  <i18n:registerTranslations directory="locales" />

  <gs:registerProfile
      name="default"
      title="Workflow comments"
      description="Require users to enter a comment before making a workflow transition"
      directory="profiles/default"
      for="Products.CMFPlone.interfaces.IPloneSiteRoot"
      provides="Products.GenericSetup.interfaces.EXTENSION"
      />

  <!-- add javascript in the plone.contentviews viewletmanager
       that is reload by changeWorkflowState kss method
   -->
  <browser:viewlet
      name="collective.wfcomment.javascript"
      view="zope.interface.Interface"
      for="Products.ATContentTypes.interfaces.IATContentType"
      manager="plone.app.layout.viewlets.interfaces.IHtmlHeadLinks"
      class=".wfcomment.WfCommentViewlet"
      permission="zope2.View"
      layer="collective.wfcomment.interfaces.IWorkflowCommentBrowserLayer"
      />

  <browser:page
      name="content_status_comment"
      for="Products.ATContentTypes.interfaces.IATContentType"
      class=".wfcomment.WfCommentView"
      permission="zope2.View"
      />

  <browser:page
      name="wfcomment-controlpanel"
      for="Products.CMFPlone.interfaces.IPloneSiteRoot"
      class=".controlpanel.WfCommentControlPanel"
      permission="cmf.ManagePortal"
      />

  <browser:viewlet
      name="collective.wfcomment.controlpaneljs"
      view=".interfaces.IWfCommentControlPanel"
      for="Products.CMFPlone.interfaces.IPloneSiteRoot"
      manager="plone.app.layout.viewlets.interfaces.IHtmlHeadLinks"
      class=".controlpanel.WfCommentControlPanelJS"
      permission="zope2.View"
      />

    <gs:upgradeStep
        title="Upgrade collective.wfcomment"
        description="upgrade step"
        source="2"
        destination="3"
        handler=".upgrades.upgrade_2_3"
        profile="collective.wfcomment:default"/>

</configure>
